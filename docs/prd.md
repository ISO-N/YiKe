# 忆刻（YiKe）— PRD（汇总版）

## 文档信息

- 用途：统一沉淀产品需求与验收口径，避免多版本 PRD 重复维护。
- 作者：YiKe 团队
- 创建日期：2025-02-25
- 最后更新：2026-02-28

---

## 1. 项目概述

### 1.1 产品定位

忆刻是一款基于**艾宾浩斯遗忘曲线**的学习任务规划应用：用户只需录入学习内容，系统自动生成复习任务并通过通知/小组件/桌面端持续提醒。

### 1.2 核心价值与原则

- **零门槛**：输入即规划，尽量不让用户理解“曲线/间隔”等术语。
- **可执行**：把“要复习什么、什么时候复习、今天做多少”说清楚。
- **可追踪**：完成/跳过有状态闭环，统计与进度给到反馈。
- **跨设备可用**：移动端/桌面端体验一致，数据可在局域网内同步。

### 1.3 目标用户

| 用户画像 | 典型场景 |
|---|---|
| 学生 | 备考、课程复习、背诵记忆 |
| 职场人 | 考证、技术面试、知识点复盘 |
| 终身学习者 | 语言学习、读书笔记、长期复习 |

### 1.4 核心概念（口径统一）

- **学习内容**：用户录入的一条知识点（标题/备注/标签/学习日期）。
- **复习任务**：系统为学习内容生成的待复习项（轮次 1-5、计划日期、状态）。
- **状态**：待复习（pending）/已完成（done）/已跳过（skipped）。
- **复习轮次**：固定为 1-5 轮，对应间隔 1/2/4/7/15 天（可在“复习间隔配置”中扩展，但默认不增加第 6 轮）。

---

## 2. 版本与范围

### 2.1 版本状态（以本汇总文档为准）

| 版本 | 主要内容 | 状态 |
|---|---|---|
| v1.0 | 核心闭环（F1-F5） | ✅ 已完成 |
| v2.0 | 日历/统计/导出（F6-F8） | ✅ 已完成 |
| v2.1 | 录入增强（F1.1-F1.6） | ✅ 已完成 |
| v2.2 | 主题系统（F9.1-F9.3） | ✅ 已完成 |
| v3.0 | 学习指南/Windows/局域网同步（F10-F12） | ✅ 已完成 |
| v3.1 | Debug 工具与体验优化（F13-F14） | 📋 规划中 |

### 2.2 本 PRD 的“在范围”

- 离线优先：核心功能无网络也可用。
- 跨平台：Android / iOS / Windows（桌面端以效率为主）。
- 局域网同步：同一局域网设备发现、配对、双向同步与状态反馈。
- Debug 工具：仅 Debug 模式下可见的模拟数据与测试辅助。

### 2.3 本 PRD 的“暂不在范围”（避免边界漂移）

- 账号体系、云端登录、多端云同步。
- 社区/公开内容/排行榜等社交属性。
- AI 自动生成学习内容（可作为未来探索，但不进入 v3.1 验收范围）。

---

## 3. 功能需求（按模块沉淀）

### 3.1 录入与内容管理（F1 / F1.1-F1.6）

**目标**：让用户尽可能低成本创建高质量学习内容，并明确后续复习路径。

- 录入字段：标题（必填，≤50字）、备注（选填）、标签（选填）、学习日期（默认今日）。
- 连续录入：保存成功后可快速继续录入。
- 批量导入：支持 TXT/CSV/Markdown 导入 → 预览/编辑 → 一次性入库。
- 快速模板：模板可管理；支持占位符（如日期相关占位符）。
- 语音/OCR：将“输入”从键盘扩展到语音与图片识别（容错与权限引导必须清晰）。
- 复习预览：录入时可预览将生成的复习节点；可配置复习间隔。
- 内容关联（主题）：内容可归到主题；主题页可聚合展示进度。

**验收要点（摘要）**

- 批量导入必须“可预览可编辑”，错误行要可定位；支持常见分隔符与空行处理。
- 复习预览与最终生成计划一致；调整间隔后对新内容生效（历史内容遵循已有计划，避免隐式重算）。
- 主题进度口径：以主题内任务的完成情况聚合（显示 completed/total 与完成率）。

### 3.2 复习任务闭环（F2 / F3）

**默认复习间隔**（学习日 D0）：D1/D3/D7/D14/D29（对应 1/2/4/7/15 天）。

- 自动生成：每条学习内容生成 5 条复习任务。
- 完成/跳过：任务从待复习进入已完成或已跳过；支持批量操作。
- 逾期提示：逾期未完成的任务需明显标识（颜色/标记）。

**验收要点（摘要）**

- 任务轮次仅允许 1-5（与表约束一致）；任何生成逻辑不得产生第 6 轮。
- 完成/跳过操作必须可追溯（至少记录时间戳）。

### 3.3 提醒与小组件（F4 / F5）

- 通知提醒：默认每日 09:00；支持免打扰时段；权限被拒要有引导。
- 桌面小组件：2×2 显示数量；4×2 显示列表；展示“今天需要复习”的信息即可。

### 3.4 日历视图（F6）

- 月历展示任务分布；日期下方以圆点/标记表达状态。
- 点击日期展示当日任务列表；支持切换月份。

### 3.5 学习统计（F7）

- 连续天数、周/月完成率、分类/标签分布。
- 数据口径必须一致：统计以任务状态与日期为准，避免“学习内容数”与“任务数”混用导致误导。

### 3.6 数据导出与备份（F8）

- 导出范围：学习内容与复习任务（可选择）。
- 导出格式：JSON/CSV。
- 分享：调用系统分享。

### 3.7 主题系统（F9.1-F9.3）

- 主题模式：跟随系统/浅色/深色。
- 深色模式：全页面适配；第三方组件（如图表、日历）也必须适配。
- 入口：设置页提供主题切换入口；切换有明确反馈与过渡动画。

### 3.8 学习指南与帮助（F10.1-F10.3）

- 底部导航新增“帮助”入口（形成 5 Tab）。
- 帮助页展示学习指南：包含原理、建议、FAQ、版本信息等；支持目录跳转。
- 内容以 Markdown 渲染，便于维护；深色/浅色适配。

### 3.9 Windows 桌面端（F11.1-F11.3）

- 支持 Windows 10+ 运行与基础体验一致。
- 桌面端优先效率：更适合键鼠操作、更大的信息密度。
- 期望能力：窗口大小/最小化托盘/快捷键（如新建、刷新）/响应式双列布局。

### 3.10 局域网数据同步（F12.1-F12.4）

**目标**：同一局域网内，多设备数据一致；同步过程“可感知、可控制、可恢复”。

- 服务发现：能发现同局域网设备（需考虑路由器/权限限制的降级策略）。
- 配对与认证：用配对码/临时凭证完成设备互信。
- 双向同步：学习内容与复习任务双向传播；支持至少 3 台设备。
- 状态管理：未连接/连接中/已连接/同步中/失败等状态对用户可见。

**验收要点（摘要）**

- 防火墙/端口被阻塞时要有可理解的错误提示与引导。
- 冲突策略必须明确（例如以更新时间或主机优先），并避免静默覆盖导致数据丢失。

### 3.11 Debug 与体验优化（v3.1：F13 / F14）

- Debug 模拟数据生成器：仅 Debug 可见；可配置数量/范围/模板；可一键清理。
- Mock 数据隔离：Mock 数据默认不参与同步与导出（避免污染真实数据）。
- 学习内容搜索：支持按标题/备注搜索；防抖；结果上限；匹配高亮。
- 复习任务筛选：按状态筛选（全部/待复习/已完成/已跳过）；展示各状态数量。
- 首页复习进度：用环形进度或等价组件展示“已完成/总数”，并能展开查看详情。

---

## 4. 非功能需求

| 类别 | 需求 |
|---|---|
| 性能 | 冷启动 ≤ 2s；录入到生成计划 ≤ 500ms；列表滚动稳定 |
| 存储 | 本地 SQLite；10,000+ 条任务查询流畅 |
| 兼容性 | Android 8.0+ / iOS 14+ / Windows 10+ |
| 离线 | 核心功能完全离线可用；同步仅在同网时可用 |
| 安全 | 敏感配置加密存储；同步需要认证；导出默认不包含 Mock 数据 |

---

## 5. 风险与应对（摘要）

| 风险 | 影响 | 应对 |
|---|---|---|
| 通知被系统限制 | 提醒失效 | 权限引导 + 小组件兜底 |
| 任务堆积导致放弃 | 体验劣化 | 逾期提示 + 筛选/搜索 + 今日进度可视化 |
| 局域网发现不稳定 | 同步不可用 | 优先支持 UDP 广播；必要时提供手动输入 IP/重试 |
| 同步冲突 | 覆盖/丢失 | 明确冲突策略 + 同步状态可见 + 关键数据日志 |
| Mock 数据污染 | 统计/同步异常 | `isMockData` 标记 + 同步/导出过滤 + 一键清理 |

---

## 6. 成功指标（建议口径）

| 指标 | 目标（上线 3 个月内） |
|---|---|
| DAU | ≥ 500 |
| 次日留存 | ≥ 40% |
| 平均复习完成率 | ≥ 60% |
| 小组件使用率 | ≥ 30% |
| 评分 | ≥ 4.5 |

---

## 7. 内容同步规则（学习指南）

- 单一事实源：`docs/prd/忆刻学习指南.md`。
- 应用内展示：同步生成到 `assets/markdown/learning_guide.md`。
- 同步方式：使用 `tool/sync_learning_guide.dart` 一键同步（生成文件不手工编辑）。

---

## 8. 更新日志

| 日期 | 更新内容 |
|---|---|
| 2025-02-25 | 创建初始 PRD（v1.0 口径） |
| 2026-02-26 | 汇总 v2.x/v3.0 需求要点 |
| 2026-02-28 | 合并归档 PRD，统一为汇总版，并补充 v3.1 验收摘要 |
